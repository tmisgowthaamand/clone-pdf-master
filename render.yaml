services:
  - type: web
    name: pdftools-backend
    env: docker
    dockerfilePath: ./Dockerfile
    dockerContext: ./
    plan: free
    region: oregon  # or singapore for better latency
    envVars:
      - key: PORT
        value: 10000
      - key: FLASK_ENV
        value: production
      - key: PYTHONUNBUFFERED
        value: 1
      - key: ALLOWED_ORIGINS
        value: "https://pdf-tools-phi.vercel.app,http://localhost:5173,http://localhost:3000"
      - key: MAX_CONTENT_LENGTH
        value: "52428800"
      - key: WEB_CONCURRENCY
        value: 1
    healthCheckPath: /health
    autoDeploy: true
    # Increase timeouts for free tier cold starts and health checks
    initialDelaySeconds: 120
    # Remove startCommand - let Dockerfile CMD handle it
